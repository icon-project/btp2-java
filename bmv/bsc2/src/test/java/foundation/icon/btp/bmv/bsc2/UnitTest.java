package foundation.icon.btp.bmv.bsc2;

import com.iconloop.score.test.ManualRevertException;
import com.iconloop.score.test.TestBase;
import foundation.icon.score.util.StringUtil;
import org.junit.jupiter.api.Test;

import java.util.ArrayList;
import java.util.List;

import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
import static org.junit.jupiter.api.Assertions.assertThrows;

public class UnitTest extends TestBase {

    public static class DecodeReceiptTest {
        public static List<byte[]> payloads = new ArrayList<>() {{
            add(StringUtil.hexToBytes("f909a201836b88ceb901000010000a0000000000000000000000000100c4000000002000004880000000080800000040000000000000000000000000000000000000000000000000000000000000000001400000000088000000000000000000002000000000800040000000000000020000000000000000005a00000000000000000001008010000000000000100000990000000080081000000000800000000000000000000000000800010000000000000004000000001000040000200000000000020000000000000400200002000000014000000000000000000001400200000000000000001020040010000000010000100020000000000000080000000000000000000000a00000f90897f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a000000000000000000000000000000000000000000000000000000acd451e1cc080f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a00000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000acd451e1cc080f902bd949fd9e050682a8795dea6ee70870a82a513d390acf863a037be353f216cf7e33639101fd610c542e6a0c0109173fa1c1d8b04d34edb7c1ba049b8450d908a4f650ee2ea4911b0c56b9aa43ec1da10a2db29343877d8824f11a000000000000000000000000000000000000000000000000000000000000001b4b90240000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001faf901f788307836312e6273638d30786161333661372e65746832857863616c6c820112b901a7f901a401b901a0f9019daa307841303763413864433530423035334341416135373636373036653234393738354633413063306633aa30783463436237423731363739353061343341356364383143643132323035396164666333393734316282011201b901400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000820113e988307836312e627363df861a6494567f5f871177f27557050887009c9728810b15871dea5357c01400000000000000f9013c949fd9e050682a8795dea6ee70870a82a513d390acf863a051f135d1c44e53689ca91af3b1bce4918d2b590d92bb76a854ab30e7de741828a098983594474fc197ab334702f0c39bb86936544432598790a877da0d108e5035a00000000000000000000000000000000000000000000000000000000000000113b8c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000083078372e69636f6e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000453454e4400000000000000000000000000000000000000000000000000000000f8bc945ebb7acb7bcaf7c1adefcf9660d39ac07d432904f884a030bd7b24c8b4484378d242d4b94ef187d71ef050444e6b1bd9b18d1b75a29438a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a0f5260ebbab59bb7656696542021cc266f9175241fdb33c2eb84fd37100156617a00000000000000000000000000000000000000000000000000000000000000112a00000000000000000000000000000000000000000000000000000000000000113f901fd94a07ca8dc50b053caaa5766706e249785f3a0c0f3f863a0a0a630e297ee9fcce0a89079bae0db692f5137271ef7d89fe33c4a5b86f2cc46a00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a00000000000000000000000000000000000000000000000000000000000000112b90180000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000f89c94a07ca8dc50b053caaa5766706e249785f3a0c0f3f884a0fac45fb08744366e971f3b233ba7bfe5070eff20085a915f6d4cbb446299398ca00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a05a41a268a7937a83e8853335a4de1649d9a990b4a2135f9922cd65f5c58ffea5a000000000000000000000000000000000000000000000000000000acd451e1cc080"));
            add(StringUtil.hexToBytes("01f909a201836b88ceb901000010000a0000000000000000000000000100c4000000002000004880000000080800000040000000000000000000000000000000000000000000000000000000000000000001400000000088000000000000000000002000000000800040000000000000020000000000000000005a00000000000000000001008010000000000000100000990000000080081000000000800000000000000000000000000800010000000000000004000000001000040000200000000000020000000000000400200002000000014000000000000000000001400200000000000000001020040010000000010000100020000000000000080000000000000000000000a00000f90897f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a000000000000000000000000000000000000000000000000000000acd451e1cc080f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a00000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000acd451e1cc080f902bd949fd9e050682a8795dea6ee70870a82a513d390acf863a037be353f216cf7e33639101fd610c542e6a0c0109173fa1c1d8b04d34edb7c1ba049b8450d908a4f650ee2ea4911b0c56b9aa43ec1da10a2db29343877d8824f11a000000000000000000000000000000000000000000000000000000000000001b4b90240000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001faf901f788307836312e6273638d30786161333661372e65746832857863616c6c820112b901a7f901a401b901a0f9019daa307841303763413864433530423035334341416135373636373036653234393738354633413063306633aa30783463436237423731363739353061343341356364383143643132323035396164666333393734316282011201b901400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000820113e988307836312e627363df861a6494567f5f871177f27557050887009c9728810b15871dea5357c01400000000000000f9013c949fd9e050682a8795dea6ee70870a82a513d390acf863a051f135d1c44e53689ca91af3b1bce4918d2b590d92bb76a854ab30e7de741828a098983594474fc197ab334702f0c39bb86936544432598790a877da0d108e5035a00000000000000000000000000000000000000000000000000000000000000113b8c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000083078372e69636f6e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000453454e4400000000000000000000000000000000000000000000000000000000f8bc945ebb7acb7bcaf7c1adefcf9660d39ac07d432904f884a030bd7b24c8b4484378d242d4b94ef187d71ef050444e6b1bd9b18d1b75a29438a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a0f5260ebbab59bb7656696542021cc266f9175241fdb33c2eb84fd37100156617a00000000000000000000000000000000000000000000000000000000000000112a00000000000000000000000000000000000000000000000000000000000000113f901fd94a07ca8dc50b053caaa5766706e249785f3a0c0f3f863a0a0a630e297ee9fcce0a89079bae0db692f5137271ef7d89fe33c4a5b86f2cc46a00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a00000000000000000000000000000000000000000000000000000000000000112b90180000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000f89c94a07ca8dc50b053caaa5766706e249785f3a0c0f3f884a0fac45fb08744366e971f3b233ba7bfe5070eff20085a915f6d4cbb446299398ca00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a05a41a268a7937a83e8853335a4de1649d9a990b4a2135f9922cd65f5c58ffea5a000000000000000000000000000000000000000000000000000000acd451e1cc080"));
            add(StringUtil.hexToBytes("02f909a201836b88ceb901000010000a0000000000000000000000000100c4000000002000004880000000080800000040000000000000000000000000000000000000000000000000000000000000000001400000000088000000000000000000002000000000800040000000000000020000000000000000005a00000000000000000001008010000000000000100000990000000080081000000000800000000000000000000000000800010000000000000004000000001000040000200000000000020000000000000400200002000000014000000000000000000001400200000000000000001020040010000000010000100020000000000000080000000000000000000000a00000f90897f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a000000000000000000000000000000000000000000000000000000acd451e1cc080f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a00000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000acd451e1cc080f902bd949fd9e050682a8795dea6ee70870a82a513d390acf863a037be353f216cf7e33639101fd610c542e6a0c0109173fa1c1d8b04d34edb7c1ba049b8450d908a4f650ee2ea4911b0c56b9aa43ec1da10a2db29343877d8824f11a000000000000000000000000000000000000000000000000000000000000001b4b90240000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001faf901f788307836312e6273638d30786161333661372e65746832857863616c6c820112b901a7f901a401b901a0f9019daa307841303763413864433530423035334341416135373636373036653234393738354633413063306633aa30783463436237423731363739353061343341356364383143643132323035396164666333393734316282011201b901400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000820113e988307836312e627363df861a6494567f5f871177f27557050887009c9728810b15871dea5357c01400000000000000f9013c949fd9e050682a8795dea6ee70870a82a513d390acf863a051f135d1c44e53689ca91af3b1bce4918d2b590d92bb76a854ab30e7de741828a098983594474fc197ab334702f0c39bb86936544432598790a877da0d108e5035a00000000000000000000000000000000000000000000000000000000000000113b8c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000083078372e69636f6e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000453454e4400000000000000000000000000000000000000000000000000000000f8bc945ebb7acb7bcaf7c1adefcf9660d39ac07d432904f884a030bd7b24c8b4484378d242d4b94ef187d71ef050444e6b1bd9b18d1b75a29438a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a0f5260ebbab59bb7656696542021cc266f9175241fdb33c2eb84fd37100156617a00000000000000000000000000000000000000000000000000000000000000112a00000000000000000000000000000000000000000000000000000000000000113f901fd94a07ca8dc50b053caaa5766706e249785f3a0c0f3f863a0a0a630e297ee9fcce0a89079bae0db692f5137271ef7d89fe33c4a5b86f2cc46a00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a00000000000000000000000000000000000000000000000000000000000000112b90180000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000f89c94a07ca8dc50b053caaa5766706e249785f3a0c0f3f884a0fac45fb08744366e971f3b233ba7bfe5070eff20085a915f6d4cbb446299398ca00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a05a41a268a7937a83e8853335a4de1649d9a990b4a2135f9922cd65f5c58ffea5a000000000000000000000000000000000000000000000000000000acd451e1cc080"));
        }};

        public static List<byte[]> unsupported = new ArrayList<>() {{
            add(StringUtil.hexToBytes("03f909a201836b88ceb901000010000a0000000000000000000000000100c4000000002000004880000000080800000040000000000000000000000000000000000000000000000000000000000000000001400000000088000000000000000000002000000000800040000000000000020000000000000000005a00000000000000000001008010000000000000100000990000000080081000000000800000000000000000000000000800010000000000000004000000001000040000200000000000020000000000000400200002000000014000000000000000000001400200000000000000001020040010000000010000100020000000000000080000000000000000000000a00000f90897f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a000000000000000000000000000000000000000000000000000000acd451e1cc080f89c9437c2a42899390ccbbaee8ada08290a8f0d7902b3f884a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a00000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000acd451e1cc080f902bd949fd9e050682a8795dea6ee70870a82a513d390acf863a037be353f216cf7e33639101fd610c542e6a0c0109173fa1c1d8b04d34edb7c1ba049b8450d908a4f650ee2ea4911b0c56b9aa43ec1da10a2db29343877d8824f11a000000000000000000000000000000000000000000000000000000000000001b4b90240000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001faf901f788307836312e6273638d30786161333661372e65746832857863616c6c820112b901a7f901a401b901a0f9019daa307841303763413864433530423035334341416135373636373036653234393738354633413063306633aa30783463436237423731363739353061343341356364383143643132323035396164666333393734316282011201b901400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000820113e988307836312e627363df861a6494567f5f871177f27557050887009c9728810b15871dea5357c01400000000000000f9013c949fd9e050682a8795dea6ee70870a82a513d390acf863a051f135d1c44e53689ca91af3b1bce4918d2b590d92bb76a854ab30e7de741828a098983594474fc197ab334702f0c39bb86936544432598790a877da0d108e5035a00000000000000000000000000000000000000000000000000000000000000113b8c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000083078372e69636f6e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000453454e4400000000000000000000000000000000000000000000000000000000f8bc945ebb7acb7bcaf7c1adefcf9660d39ac07d432904f884a030bd7b24c8b4484378d242d4b94ef187d71ef050444e6b1bd9b18d1b75a29438a0000000000000000000000000a07ca8dc50b053caaa5766706e249785f3a0c0f3a0f5260ebbab59bb7656696542021cc266f9175241fdb33c2eb84fd37100156617a00000000000000000000000000000000000000000000000000000000000000112a00000000000000000000000000000000000000000000000000000000000000113f901fd94a07ca8dc50b053caaa5766706e249785f3a0c0f3f863a0a0a630e297ee9fcce0a89079bae0db692f5137271ef7d89fe33c4a5b86f2cc46a00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a00000000000000000000000000000000000000000000000000000000000000112b90180000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000154252494447455f4e46545f46524f4d5f434841494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000acd451e1cc0000000000000000000000000000000000000000000000000000000000000003e6274703a2f2f30786161333661372e657468322f3078333931356463386335376561346330393738633334656636343832306466656233373630636566370000f89c94a07ca8dc50b053caaa5766706e249785f3a0c0f3f884a0fac45fb08744366e971f3b233ba7bfe5070eff20085a915f6d4cbb446299398ca00000000000000000000000003915dc8c57ea4c0978c34ef64820dfeb3760cef7a05a41a268a7937a83e8853335a4de1649d9a990b4a2135f9922cd65f5c58ffea5a000000000000000000000000000000000000000000000000000000acd451e1cc080"));
        }};

        @Test
        void decodeValidReceipts() {
            payloads.forEach((payload) -> assertDoesNotThrow(() -> Receipt.fromBytes(payload)));
        }

        @Test
        void decodeUnsupported() {
            unsupported.forEach((payload) -> assertThrows(ManualRevertException.class,
                    () -> Receipt.fromBytes(payload), "Unsupported typed transaction"));
        }
    }
    public static class VoteAttestationTest {
        public static Validators validators = new Validators(new ArrayList<>() {{
            add(new Validator(EthAddress.of("1284214b9b9c85549ab3d2b972df0deef66ac2c9"),
                    BLSPublicKey.of("8e82934ca974fdcd97f3309de967d3c9c43fa711a8d673af5d75465844bf8969c8d1948d903748ac7b8b1720fa64e50c")));
            add(new Validator(EthAddress.of("35552c16704d214347f29fa77f77da6d75d7c752"),
                    BLSPublicKey.of("b742ad4855bae330426b823e742da31f816cc83bc16d69a9134be0cfb4a1d17ec34f1b5b32d5c20440b8536b1e88f0f2")));
            add(new Validator(EthAddress.of("47788386d0ed6c748e03a53160b4b30ed3748cc5"),
                    BLSPublicKey.of("000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")));
            add(new Validator(EthAddress.of("980a75ecd1309ea12fa2ed87a8744fbfc9b863d5"),
                    BLSPublicKey.of("89037a9ace3b590165ea1c0c5ac72bf600b7c88c1e435f41932c1132aae1bfa0bb68e46b96ccb12c3415e4d82af717d8")));
            add(new Validator(EthAddress.of("a2959d3f95eae5dc7d70144ce1b73b403b7eb6e0"),
                    BLSPublicKey.of("b973c2d38487e58fd6e145491b110080fb14ac915a0411fc78f19e09a399ddee0d20c63a75d8f930f1694544ad2dc01b")));
            add(new Validator(EthAddress.of("b71b214cb885500844365e95cd9942c7276e7fd8"),
                    BLSPublicKey.of("a2750ec6dded3dcdc2f351782310b0eadc077db59abca0f0cd26776e2e7acb9f3bce40b1fa5221fd1561226c6263cc5f")));
            add(new Validator(EthAddress.of("f474cf03cceff28abc65c9cbae594f725c80e12d"),
                    BLSPublicKey.of("96c9b86c3400e529bfe184056e257c07940bb664636f689e8d2027c834681f8f878b73445261034e946bb2d901b4b878")));
        }});

        @Test
        void verifyValidVoteSignature() {
            VoteAttestation attestation = VoteAttestation.fromBytes(StringUtil.hexToBytes("f8b27bb860b52b3719228d17a7d7dc98d69adcc43d6e663ee9d265d1ca4fb3a9cd0d7eff6434b40b1135190ee1dc683684cc48f2290495bf14bc187d068a98a396bca4fa585bfa9c355198fa543a62db80cf4f1d18d913f353407f2aa35336a2cdd53e85daf84c8401e53abea0826b43a928a31836f6025f9ba8d70691c0c32fe5b48b219792365203e8e37f348401e53abfa0dc77f6bcfb22b3ea2de6cb5f2dbe9fd2b8441dbb9785ce2d0d73af81f4709f3880"));
            assertDoesNotThrow(() -> attestation.verify(validators));
        }

        @Test
        void verifyValidVoteSignatureWithWrongMessage() {
            VoteAttestation attestation = VoteAttestation.fromBytes(StringUtil.hexToBytes("f8b27bb860b52b3719228d17a7d7dc98d69adcc43d6e663ee9d265d1ca4fb3a9cd0d7eff6434b40b1135190ee1dc683684cc48f2290495bf14bc187d068a98a396bca4fa585bfa9c355198fa543a62db80cf4f1d18d913f353407f2aa35336a2cdd53e85daf84c8401e53abea0826b43a928a31836f6025f9ba8d70691c0c32fe5b48b219792365203e8e37f348401e53abfa0dc77f6bcfb22b3ea2de6cb5f2dbe9fd2b8441dbb9785ce2d0d73af71f4709f3880"));
            assertThrows(ManualRevertException.class, () -> attestation.verify(validators));
        }

        @Test
        void verifyInvalidVoteSignature() {
            VoteAttestation attestation = VoteAttestation.fromBytes(StringUtil.hexToBytes("f8b27bb860b53b3719228d17a7d7dc98d69adcc43d6e663ee9d265d1ca4fb3a9cd0d7eff6434b40b1135190ee1dc683684cc48f2290495bf14bc187d068a98a396bca4fa585bfa9c355198fa543a62db80cf4f1d18d913f353407f2aa35336a2cdd53e85daf84c8401e53abea0826b43a928a31836f6025f9ba8d70691c0c32fe5b48b219792365203e8e37f348401e53abfa0dc77f6bcfb22b3ea2de6cb5f2dbe9fd2b8441dbb9785ce2d0d73af81f4709f3880"));
            assertThrows(IllegalArgumentException.class, () -> attestation.verify(validators));
        }
    }
}


